(function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):n.storagejs=t()})(this,function(){return function(n){var t=null,r=localStorage[n]?JSON.parse(localStorage[n]):[],e=function(n){var t=0;for(var r in n)t++;return t},i={findById:function(n,e){var l=i.findIndexById(n),o=null;return null===l?t="Data with ID "+n+" not found.":o=r[l],e?(e(t,o),void 0):o},findIndexById:function(n,e){var i=null;for(var l in r)r[l]._id==n&&(i=l);return e?(e(t,i),void 0):i},findByAttributes:function(n,r){var e=i.findAllByAttributes(n),l=null;return e.length>0&&(l=e[0]),r?(r(t,l),void 0):l},findAll:function(n,r){var e=i.findAllByAttributes(n);return r?(r(t,e),void 0):e},findAllByAttributes:function(n,i){var l=[],o=e(n);for(var u in r){var a=o;for(var d in n)r[u][d]==n[d]&&a--;0===a&&l.push(r[u])}return i?(i(t,l),void 0):l},findAllByAttribute:function(n,e,i){var l=[];for(var o in r)r[o][n]==e&&l.push(r[o]);return i?(i(t,l),void 0):l},findByAttribute:function(n,r,e){var l=i.findAllByAttribute(n,r),o=null;return l.length>0&&(o=l[0]),e?(e(t,o),void 0):o},all:function(n){return n?(n(t,r),void 0):r},insert:function(e,l,o){var u=l,a=o;return"object"==typeof e?(u=e,a=l):u._id=e,u._id?null===i.findById(u._id)?(r.push(u),localStorage.setItem(n,JSON.stringify(r)),t=null):t="Data with ID "+u._id+" has been registered.":t="Please insert ID.",a?(a(t,null),void 0):null!==t},batchInsert:function(n,r){var e=0;for(var l in n)n[l]._id===void 0?e++:null!==i.findIndexById(n[l]._id)&&e++;if(0===e)for(var l in n)i.insert(n[l]);else t="Batch insert failed.";return r?(r(t,null),void 0):null!==t},updateById:function(e,l,o){var u=i.findIndexById(e);if(null===u)t="Data with ID "+e+" not found.";else{var a=r[u],d=0;for(var f in l)a[f]===void 0?d++:a[f]=l[f];0===d?(r[u]=a,t=null,localStorage.setItem(n,JSON.stringify(r))):t="Key Update not match."}return o?(o(t,null),void 0):null!==t},updateAllByAttributes:function(i,l,o){var u=r,a=e(i),d=0,f=0;for(var v in u){var s=a;for(var c in i)u[v][c]==i[c]&&s--;if(0===s){f++;var y=u[v],I=0;for(var g in l)y[g]===void 0?I++:y[g]=l[g];0===I?u[v]=y:d++}}return 0===f?t="Data not found.":d>0?t="Key Update not match.":(t=null,localStorage.setItem(n,JSON.stringify(u))),o?(o(t,null),void 0):null!==t},deleteById:function(e,l){var o=i.findIndexById(e);return null===o?t="Data with ID "+e+" not found.":(r.splice(o,1),localStorage.setItem(n,JSON.stringify(r))),l?(l(t,null),void 0):null!==t},deleteAllByAttribute:function(e,i,l){var o=0,u=[];for(var a in r)r[a][e]===i?o++:u.push(r[a]);return o>0?localStorage.setItem(n,JSON.stringify(u)):t="Data not found.",l?(l(t,null),void 0):null!==t},deleteAllByAttributes:function(i,l){var o=[],u=0,a=e(i);for(var d in r){var f=a;for(var v in i)r[d][v]==i[v]&&f--;0===f?u++:o.push(r[d])}return u>0?localStorage.setItem(n,JSON.stringify(o)):t="Data not found.",l?(l(t,null),void 0):null!==t},deleteAll:function(r){return localStorage.setItem(n,JSON.stringify([])),r?(r(t,null),void 0):null!==t},remove:function(r){return localStorage.removeItem(n),r?(r(t,null),void 0):null!==t}};return i}});